/**
 * Name: WebstartJS
 * Author: Nolann MorencÃ©
 * Version: 1.0.0
 */

let Data = null;window.addEventListener("load", () => {fetch("./start.json").then(res => res.json()).then(json => {Data = json;document.title = json.title;Default.loadPage(json.start_page);});});let scriptIteration = 0;function LoadComponent(url) {scriptIteration++;let script = document.createElement("script");script.src = "./../app/"+url+"?n="+scriptIteration;script.type = "module";document.body.appendChild(script);}class Header {constructor({title, menu, styles}) {this.title = title ?? "";this.menu = menu ?? [];this.styles = styles ?? {};}render() {let h1 = document.createElement("h1");h1.textContent = this.title;let nav = document.createElement("nav");this.menu.forEach(item => {let a = document.createElement("a");a.href = item.src ?? "#";a.textContent = item.name ?? "page";a.onclick = (event) => {if(a.href.includes("page:")) {event.preventDefault();Default.loadPage(a.href.split(":")[1]);}};nav.append(a);});header.append(h1, nav);header.classList.replace("hide", "row");Default.setStyle(header, this.styles);}}let Main = {add: (...elements) => {elements.forEach(element => {if(!Main.has(element)) {element.render();}});},remove: (element) => {[...main.children].find(child => child.outerHTML === element.getNode().outerHTML).remove();},replace: (oldElement, newElement) => {main.insertBefore(newElement.getNode(), [...main.children].find(child => child.outerHTML === oldElement.getNode().outerHTML));Main.remove(oldElement);},has: (element) => {return ![...main.children].every(child => child.outerHTML !== element.getNode().outerHTML);}};class Title {constructor({content, size, styles}) {this.content = content ?? "title";this.size = size ?? 1;this.styles = styles ?? {};}getNode() {let title = document.createElement("h"+this.size);title.textContent = this.content;Default.setStyle(title, this.styles);return title;}render() {main.append(this.getNode());}}export {Data,LoadComponent,Header,Main,Title};let Default = {variables: {pageIteration: 0},clear: () => {let header = document.getElementById("header");let main = document.getElementById("main");let footer = document.getElementById("footer");let scripts = document.body.querySelectorAll("script");while(header.hasChildNodes()) { header.removeChild(header.firstChild); }while(main.hasChildNodes()) { main.removeChild(main.firstChild); }while(footer.hasChildNodes()) { footer.removeChild(footer.firstChild); }scripts.forEach(script => document.body.removeChild(script));header.classList.replace("row", "hide");main.classList.replace("row", "hide");footer.classList.replace("row", "hide");},loadPage: (page) => {Default.variables.pageIteration++;if(document.head.lastChild.id == "page") {document.head.removeChild(document.head.lastChild);}Default.clear();let script = document.createElement("script");script.id = "page";script.src = "./app/"+page+".js?n"+Default.variables.pageIteration;script.type = "module";document.head.append(script);},setStyle: (element, styles) => {Object.entries(styles).forEach(([key, value]) => {element.style.setProperty("--"+key, value);});}}